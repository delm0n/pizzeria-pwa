<template>
  <div class="container">
    <header id="header" class="header-wrapper">
      <div class="logo">
        <div @click="goBack">
          <h1 v-if="!logo">Pizzeria</h1>
          <svg
            v-else
            class="arrow"
            width="20px"
            height="1.4em"
            viewBox="0 0 9 15"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M8.6 12.701L3.299 7.493 8.6 2.285A1.337 1.337 0 009 1.338a1.317 1.317 0 00-.4-.946A1.365 1.365 0 007.638 0a1.384 1.384 0 00-.963.392L.4 6.553a1.32 1.32 0 000 1.893l6.274 6.161a1.363 1.363 0 00.963.393 1.384 1.384 0 00.964-.393 1.348 1.348 0 000-1.906z"
              fill="#50A684"
            ></path>
          </svg>
        </div>

        <theme-toggle />
      </div>

      <div class="icon-box">
        <NuxtLink :to="'/bonus'" class="icon-box__coin">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="45"
            height="45"
            viewBox="0 0 45 45"
            fill="none"
          >
            <path
              d="M18.8789 1.40625C16.8223 1.59961 14.5019 2.30274 12.6562 3.28711C10.8457 4.25391 9.65038 5.15039 7.99804 6.80274C6.78515 8.01563 6.59179 8.26172 5.50194 9.89649C4.95702 10.7227 3.79687 12.7441 3.79687 12.8848C3.79687 12.9199 3.67382 13.2539 3.51562 13.6055C3.18163 14.4141 2.54882 16.3652 2.35546 17.1387C1.16015 22.4297 1.81054 27.9844 4.13085 32.6953C6.18749 36.8262 9.24609 39.9727 13.0781 41.8535C15.6445 43.1191 18.2812 43.6816 21.0059 43.541C22.5351 43.4531 22.4824 43.4531 24.0117 43.541C31.2187 43.9102 38.1094 39.1992 41.3613 31.7285C42.6797 28.7051 43.2598 25.8047 43.2598 22.4121C43.2598 14.6777 39.5156 7.61133 33.4687 3.86719C31.5527 2.67188 29.4609 1.89844 27.2109 1.5293C26.4023 1.38867 24.3808 1.33594 22.9219 1.40625C22.5527 1.42383 21.5859 1.40625 20.7773 1.38867C19.916 1.38867 19.0898 1.38867 18.8789 1.40625ZM26.8242 2.97071C30.6562 3.49805 34.207 5.48438 36.8613 8.57813C41.7305 14.2207 43.1367 22.6758 40.5 30.1289C40.3066 30.6563 39.8848 31.623 39.5508 32.291C37.2656 36.8965 33.5742 40.1484 29.0918 41.502C27.5098 41.9766 26.7363 42.082 24.6973 42.082C22.6055 42.082 21.8144 41.959 19.8809 41.3262C15.7148 39.9727 12.041 36.6856 9.8789 32.3965C7.03124 26.7363 6.8203 19.6172 9.3164 13.8164C11.4785 8.77149 15.2402 5.13282 19.8984 3.6211C20.8301 3.32227 22.1836 3.00586 23.0449 2.90039C23.7305 2.8125 25.9805 2.84766 26.8242 2.97071ZM16.9805 3.26953C16.9101 3.30469 16.5059 3.55078 16.1016 3.79688L15.3457 4.25391H14.625C14.0625 4.25391 13.9394 4.23633 14.0625 4.16602C14.4316 3.9375 16.7168 3.19922 16.998 3.19922C17.0859 3.18164 17.0859 3.19922 16.9805 3.26953ZM12.3574 6.80274L11.3379 7.875H10.0547H8.77147L9.35155 7.33008C9.66796 7.03125 10.2305 6.53907 10.582 6.25782L11.2324 5.73047H12.3047H13.3769L12.3574 6.80274ZM10.0019 9.59766C9.61522 10.1953 8.98241 11.2852 8.73632 11.7422L8.47265 12.2695H7.0664H5.66015L5.80077 12.0059C6.06444 11.4785 6.52148 10.7402 7.01366 10.0723L7.50585 9.38672H8.84179H10.1601L10.0019 9.59766ZM7.73437 13.7988C7.73437 13.834 7.57616 14.3262 7.36523 14.8887L6.99608 15.9258L5.58983 15.9434C4.42968 15.9609 4.18358 15.9434 4.18358 15.8555C4.18358 15.75 4.62304 14.5195 4.88671 13.8691C4.93944 13.7461 5.09765 13.7285 6.34569 13.7285C7.11913 13.7461 7.73437 13.7637 7.73437 13.7988ZM6.64452 17.4727C6.62694 17.5254 6.53905 17.9473 6.46874 18.4043C6.38085 18.8613 6.31054 19.3184 6.29296 19.4063C6.2578 19.5996 6.24023 19.5996 4.85155 19.5996C4.07812 19.5996 3.4453 19.582 3.42772 19.5293C3.39257 19.4766 3.62108 18.0352 3.72655 17.5781L3.77929 17.3672H5.23827C6.36327 17.3672 6.67968 17.4023 6.64452 17.4727ZM6.13476 21.2695C6.11718 21.4102 6.08202 21.9199 6.08202 22.377V23.2383H4.64062H3.19921V22.2539C3.19921 21.709 3.21679 21.2168 3.25194 21.1465C3.2871 21.0234 3.51562 21.0059 4.74608 21.0059H6.18749L6.13476 21.2695ZM6.20507 24.8203C6.22265 24.9258 6.29296 25.3477 6.34569 25.752C6.39843 26.1563 6.46874 26.5781 6.48632 26.6836L6.52147 26.877H5.08007H3.63866L3.58593 26.6484C3.48046 26.1738 3.30468 24.7676 3.33983 24.7148C3.35741 24.6797 4.0078 24.6621 4.76366 24.6621C6.15233 24.6445 6.16991 24.6445 6.20507 24.8203ZM6.87304 28.459C6.99608 28.8633 7.43554 30.2871 7.47069 30.3926C7.50585 30.498 7.29491 30.5156 6.08202 30.5156H4.64062L4.44726 29.9531C4.34179 29.6543 4.18358 29.1621 4.09569 28.8809L3.95507 28.3711H5.39648C6.48632 28.3535 6.85546 28.3711 6.87304 28.459ZM8.49022 32.7481C8.70116 33.1523 9.03515 33.8027 9.26366 34.1543C9.4746 34.5234 9.65038 34.8398 9.65038 34.8398C9.65038 34.8398 9.05272 34.8574 8.31444 34.8574H6.96093L6.69726 34.4707C6.29296 33.8731 6.06444 33.4863 5.64257 32.6953L5.23827 31.9746H6.67968H8.10351L8.49022 32.7481ZM11.0391 36.7383C11.1973 36.9492 11.6191 37.4238 11.9883 37.8106L12.6387 38.4961H11.4609H10.2656L9.50976 37.8106C9.10546 37.4238 8.63085 36.9492 8.45507 36.7383L8.15624 36.3516H9.45702H10.7578L11.0391 36.7383ZM15.2754 40.6582C15.8203 41.0273 16.4531 41.4141 16.6816 41.5371C16.9101 41.6602 17.0859 41.7656 17.0508 41.7832C16.998 41.8535 15.8379 41.5195 14.9238 41.1856C14.1504 40.9043 12.5332 40.1309 12.5332 40.043C12.5332 40.0254 12.9375 40.0078 13.4121 40.0078H14.291L15.2754 40.6582Z"
              fill="black"
            />
            <path
              d="M22.8019 20.9608C23.6249 21.3055 24.5715 20.9178 24.9162 20.0948C25.2609 19.2719 24.8731 18.3253 24.0502 17.9806C23.2272 17.6359 22.2806 18.0236 21.9359 18.8466C21.5912 19.6696 21.9789 20.6162 22.8019 20.9608Z"
              fill="black"
            />
            <path
              d="M23.5664 26.0107C22.7435 25.6661 21.7969 26.0539 21.4521 26.8769C21.1073 27.7002 21.4951 28.6469 22.3179 28.9915C23.141 29.3363 24.0877 28.9485 24.4325 28.1252C24.7772 27.3022 24.3895 26.3555 23.5664 26.0107Z"
              fill="black"
            />
            <path
              d="M26.6445 24.9604C27.4674 25.3051 28.414 24.9174 28.7587 24.0944C29.1034 23.2714 28.7157 22.3248 27.8927 21.9802C27.0697 21.6355 26.1232 22.0232 25.7785 22.8462C25.4338 23.6691 25.8215 24.6157 26.6445 24.9604Z"
              fill="black"
            />
            <path
              d="M37.1747 18.0661C34.8636 15.7363 32.1638 13.9151 29.1504 12.653C26.1489 11.3958 22.9633 10.7517 19.6821 10.7384C19.4548 10.7376 19.2366 10.8271 19.0752 10.9871C18.9139 11.1471 18.8228 11.3648 18.822 11.592L18.8087 15.1688C18.8086 15.1692 18.8089 15.1698 18.8089 15.1703L18.7277 35.5138C18.7264 35.8622 18.9363 36.1738 19.2533 36.3066C19.2762 36.3162 19.2997 36.3248 19.3236 36.3325C19.6348 36.4321 19.971 36.3451 20.195 36.1177L34.6306 21.7969C34.631 21.7966 34.6313 21.7964 34.6317 21.7961L37.17 19.2774C37.5057 18.944 37.5079 18.4018 37.1747 18.0661ZM28.4886 14.2331C31.0307 15.2978 33.3333 16.7902 35.3443 18.6756L34.0211 19.9885C32.1844 18.2785 30.0852 16.9229 27.7697 15.9531C25.4632 14.987 23.0301 14.4444 20.525 14.3356L20.5318 12.4705C23.2848 12.5812 25.9574 13.1729 28.4886 14.2331ZM20.4492 33.4525L20.5184 16.051C22.7972 16.1578 25.01 16.6545 27.1078 17.5331C29.2146 18.4156 31.1264 19.6468 32.803 21.1968L20.4492 33.4525Z"
              fill="black"
            />
          </svg>
          <div class="balance" v-if="storeClient.client.Bonus > 0">
            <p>
              {{ storeClient.client.Bonus }}
            </p>
          </div>

          <p v-if="viewport.isGreaterOrEquals('mobileWide')">Бонусы</p>
        </NuxtLink>

        <div
          v-if="!storeClient.isAutorization"
          @click="storeModal.openModalEnter()"
        >
          <button
            v-if="viewport.isGreaterOrEquals('mobileWide')"
            class="button"
          >
            Войти
          </button>

          <svg
            v-else
            class="icon-box__login"
            xmlns="http://www.w3.org/2000/svg"
            width="40"
            height="42"
            viewBox="0 0 40 42"
            fill="none"
          >
            <path
              d="M20 23.1C13.6344 23.1 8.44998 17.9156 8.44998 11.55C8.44998 5.18437 13.6344 0 20 0C26.3656 0 31.55 5.18437 31.55 11.55C31.55 17.9156 26.3656 23.1 20 23.1ZM20 2.1C14.791 2.1 10.55 6.34102 10.55 11.55C10.55 16.759 14.791 21 20 21C25.209 21 29.45 16.759 29.45 11.55C29.45 6.34102 25.209 2.1 20 2.1Z"
              fill="black"
            />
            <path
              d="M36.8 42H3.19999C1.46093 42 0.0499878 40.5891 0.0499878 38.85C0.0499878 38.7106 0.0828004 35.3145 2.62577 31.9184C4.11053 29.9414 6.13671 28.3746 8.65507 27.259C11.7312 25.8891 15.5457 25.2 20.0082 25.2C24.4707 25.2 28.2851 25.8891 31.3613 27.259C33.8797 28.3746 35.9058 29.9414 37.3824 31.9184C39.9254 35.3063 39.9582 38.7024 39.9582 38.85C39.95 40.5891 38.5391 42 36.8 42ZM20 27.3C12.6746 27.3 7.27694 29.3016 4.37303 33.0914C2.19921 35.9297 2.14999 38.8254 2.14999 38.8582C2.14999 39.4324 2.61757 39.9082 3.19999 39.9082H36.8C37.3824 39.9082 37.85 39.4406 37.85 38.8582C37.85 38.8336 37.8008 35.9297 35.6269 33.0914C32.723 29.3016 27.3172 27.3 20 27.3Z"
              fill="black"
            />
          </svg>
        </div>

        <NuxtLink to="/account" class="icon-box__account" v-else>
          <svg
            class="icon-box__login"
            xmlns="http://www.w3.org/2000/svg"
            width="40"
            height="42"
            viewBox="0 0 40 42"
            fill="none"
          >
            <path
              d="M20 23.1C13.6344 23.1 8.44998 17.9156 8.44998 11.55C8.44998 5.18437 13.6344 0 20 0C26.3656 0 31.55 5.18437 31.55 11.55C31.55 17.9156 26.3656 23.1 20 23.1ZM20 2.1C14.791 2.1 10.55 6.34102 10.55 11.55C10.55 16.759 14.791 21 20 21C25.209 21 29.45 16.759 29.45 11.55C29.45 6.34102 25.209 2.1 20 2.1Z"
              fill="black"
            />
            <path
              d="M36.8 42H3.19999C1.46093 42 0.0499878 40.5891 0.0499878 38.85C0.0499878 38.7106 0.0828004 35.3145 2.62577 31.9184C4.11053 29.9414 6.13671 28.3746 8.65507 27.259C11.7312 25.8891 15.5457 25.2 20.0082 25.2C24.4707 25.2 28.2851 25.8891 31.3613 27.259C33.8797 28.3746 35.9058 29.9414 37.3824 31.9184C39.9254 35.3063 39.9582 38.7024 39.9582 38.85C39.95 40.5891 38.5391 42 36.8 42ZM20 27.3C12.6746 27.3 7.27694 29.3016 4.37303 33.0914C2.19921 35.9297 2.14999 38.8254 2.14999 38.8582C2.14999 39.4324 2.61757 39.9082 3.19999 39.9082H36.8C37.3824 39.9082 37.85 39.4406 37.85 38.8582C37.85 38.8336 37.8008 35.9297 35.6269 33.0914C32.723 29.3016 27.3172 27.3 20 27.3Z"
              fill="black"
            />
          </svg>

          <p v-html="'Профиль'"></p>
        </NuxtLink>
      </div>
    </header>
  </div>
</template>

<script setup lang="ts">
import ThemeToggle from "~/components/UI/ThemeToggle.vue";
import { pageClick } from "@/utils/pageClick";

const route = useRoute();
const router = useRouter();
const viewport = useViewport();

const logo = computed(() => {
  return route.path != "/" && viewport.isLessThan("mobileWide");
});

const goBack = () => {
  pageClick();
  router.back();
};

const storeClient = useClientStore();
const storeModal = useModalStore();
</script>

<style lang="scss">
.header-wrapper {
  padding: 20px 0;
  display: flex;
  align-items: center;
  justify-content: space-between;
  width: 100%;
  background: var(--background);

  @media (max-width: 992px) {
    padding: 16px 0;
  }

  @media (max-width: 576px) {
    padding: 12px 0;
  }

  * {
    user-select: none;
  }

  .logo {
    display: flex;
    align-items: center;

    h1 {
      color: var(--accent);
      margin-right: 15px;

      @media (max-width: 576px) {
        margin-right: 5px;
      }
    }

    svg.arrow {
      display: block;
      margin-right: 15px;

      path {
        fill: var(--accent);
      }
    }
  }

  .icon-box {
    display: flex;
    align-items: center;

    a:not(:last-child) {
      margin-right: 30px;

      @media (max-width: 576px) {
        margin-right: 10px;
      }
    }

    svg {
      display: block;
      path {
        fill: var(--icons);
        stroke: var(--icons);
        stroke-width: 0.15px;
      }
    }

    &__coin {
      display: flex;
      flex-direction: column;
      align-items: center;
      cursor: pointer;
      position: relative;

      .balance {
        position: absolute;
        background: var(--accent);
        border-radius: 100px;
        padding: 3px 6px;
        top: -6px;
        left: calc(50% + 4px);

        @media (max-width: 576px) {
          padding: 2px 4px;
          top: -2px;
          font-size: 10px;
        }

        p {
          color: rgb(252, 252, 253);
          font-size: 12px;

          @media (max-width: 576px) {
            font-size: 10px;
          }
        }
      }

      svg {
        transition: transform 0.3s;

        @media (max-width: 576px) {
          width: 32px;
        }
      }

      p {
        transition: all 0.15s;
        font-weight: 600;
        color: var(--text-color);
      }

      @media (hover: hover) {
        &:hover {
          svg {
            transform: translateY(-3px);
          }
        }
      }
    }

    &__login {
      width: 25px;
      height: 45px;
      cursor: pointer;

      @media (min-width: 577px) {
        path {
          stroke-width: 0.85px !important;
        }
      }

      @media (hover: hover) {
        &:hover {
          opacity: 0.9;
        }
      }
    }

    .main-button {
      width: 93px;
    }

    &__account {
      display: flex;
      align-items: center;
      flex-direction: column;

      p {
        font-weight: 600;
        color: var(--text-color);

        @media (max-width: 576px) {
          display: none;
        }
      }
    }
  }
}
</style>
