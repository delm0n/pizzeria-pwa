<template>
  <div @click="toggleTheme" class="switch">
    <div
      :class="[
        'switch-rounded',
        currentTheme == 'dark' ? 'switch-rounded--active' : '',
      ]"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="20"
        height="20"
        viewBox="0 0 20 20"
        fill="none"
      >
        <g clip-path="url(#clip0_199_2)">
          <path
            d="M10 2.19141C5.69796 2.19141 2.19183 5.69753 2.19183 9.99957C2.19183 14.3016 5.69796 17.8077 10 17.8077C14.302 17.8077 17.8082 14.3016 17.8082 9.99957C17.8082 5.69753 14.302 2.19141 10 2.19141ZM11.3633 6.90569C11.5061 7.0812 11.4571 7.33426 11.2857 7.47712C11.0041 7.64039 10.8082 7.50977 10.7306 7.39957L10.4775 7.0812C10.3347 6.90569 10.3837 6.65263 10.5551 6.50977C10.7265 6.36692 10.9837 6.4159 11.1265 6.58732L11.3633 6.90569ZM11.4775 10.3506C11.4122 10.5098 11.2082 10.6526 10.9551 10.5588C10.6531 10.4322 10.4 10.1792 10.2735 9.86079C10.1959 9.65263 10.2898 9.4159 10.4939 9.33835C10.702 9.26079 10.9388 9.35467 11.0163 9.55875C11.0653 9.66896 11.1592 9.76692 11.2694 9.81181C11.4612 9.90569 11.5551 10.1424 11.4775 10.3506ZM5.5551 6.1261C5.74694 6.10977 5.95102 6.17508 6.1102 6.28528C6.28571 6.41181 6.33061 6.66488 6.18775 6.85671C5.92653 7.16283 5.61632 6.93426 5.61632 6.93426C5.39592 6.95059 5.20408 6.77508 5.18775 6.55467C5.15918 6.33426 5.33469 6.14243 5.5551 6.1261ZM4.09387 11.1098C3.91836 10.9832 3.87347 10.7302 4.01632 10.5383C4.14285 10.3628 4.39592 10.3179 4.58775 10.4608L5.1102 10.8404C5.28571 10.9669 5.33061 11.22 5.18775 11.4118C5.1102 11.522 4.88571 11.6608 4.63265 11.4894L4.09387 11.1098ZM5.47755 14.7914C5.4 14.869 5.22449 15.0363 4.90612 14.8077L4.69796 14.5996C4.53877 14.4404 4.53877 14.1873 4.69796 14.0281C4.85714 13.869 5.1102 13.869 5.26938 14.0281L5.47755 14.2363C5.63673 14.3792 5.63673 14.6485 5.47755 14.7914ZM6.93469 13.2526C6.6653 13.469 6.44081 13.3179 6.36326 13.2363L6.0449 12.9016C5.88571 12.7424 5.88571 12.4894 6.0449 12.3302C6.20408 12.171 6.45714 12.171 6.61632 12.3302L6.93469 12.6649C7.09387 12.8404 7.09387 13.1098 6.93469 13.2526ZM5.85714 10.3955C5.14285 10.3955 4.57143 9.82406 4.57143 9.10977C4.57143 8.39549 5.14285 7.82406 5.85714 7.82406C6.57143 7.82406 7.14285 8.39549 7.14285 9.10977C7.14285 9.82406 6.57143 10.3955 5.85714 10.3955ZM6.74694 4.80773C6.66938 4.59957 6.76326 4.36283 6.96734 4.28528C7.2204 4.17508 7.47347 4.10977 7.74694 4.06488C7.96734 4.03222 8.17551 4.19141 8.20816 4.39957C8.24081 4.61998 8.08163 4.82814 7.87347 4.86079C7.6653 4.89345 7.47755 4.93835 7.28571 5.01998C7.00408 5.15467 6.80816 4.96692 6.74694 4.80773ZM9.1102 16.3955C9.04489 16.571 8.86938 16.7179 8.60408 16.6485L7.87347 16.4118C7.6653 16.3465 7.5551 16.1098 7.6204 15.9057C7.68571 15.6975 7.92245 15.5873 8.12653 15.6526L8.85714 15.8894C9.07755 15.9506 9.19183 16.1914 9.1102 16.3955ZM9.64898 11.9057C9.57143 12.0322 9.37959 12.1996 9.1102 12.0649C8.87347 11.922 8.64898 11.7465 8.46122 11.5424C8.31836 11.3669 8.33469 11.1139 8.49387 10.971C8.66938 10.8281 8.92245 10.8445 9.0653 11.0037C9.19183 11.1465 9.33469 11.2567 9.49387 11.3547C9.69796 11.4608 9.76326 11.7139 9.64898 11.9057ZM9.64898 8.42814C9.32653 8.60773 9.1551 8.47712 9.07755 8.37916C8.90204 8.171 8.75918 7.96692 8.64898 7.73018C8.5551 7.52202 8.63265 7.28528 8.84081 7.19141C9.04898 7.09753 9.28571 7.17508 9.37959 7.38324C9.45714 7.55875 9.57143 7.71794 9.69796 7.86079C9.84081 8.0159 9.82449 8.26896 9.64898 8.42814ZM9.84081 3.90569C9.80816 3.68528 9.95102 3.47712 10.1755 3.44447C10.4775 3.39549 10.7959 3.50977 10.9837 3.74651C11.1265 3.92202 11.1102 4.17508 10.9347 4.31794C10.6612 4.50569 10.4408 4.36692 10.3633 4.26896C10.3469 4.25263 10.3143 4.2363 10.2857 4.2363C10.0775 4.26896 9.87347 4.1261 9.84081 3.90569ZM11.3633 15.62C10.6326 15.62 10.0449 15.0322 10.0449 14.3016C10.0449 13.571 10.6326 12.9832 11.3633 12.9832C12.0939 12.9832 12.6816 13.571 12.6816 14.3016C12.6816 15.0159 12.0939 15.62 11.3633 15.62ZM13.2694 12.2526C13.0735 12.3261 12.9061 12.1873 12.8245 12.0771C12.6653 12.0118 12.5551 11.8567 12.5714 11.6812C12.5878 11.4608 12.7633 11.2853 13 11.3016C13.2694 11.3179 13.5061 11.5098 13.5714 11.7792C13.6204 11.9832 13.4939 12.2077 13.2694 12.2526ZM12.4939 6.60365C12.4939 5.77916 13.1755 5.09753 14 5.09753C14.8245 5.09753 15.5061 5.77916 15.5061 6.60365C15.5061 7.42814 14.8245 8.10977 14 8.10977C13.1592 8.10977 12.4939 7.44447 12.4939 6.60365ZM15.9224 12.62L15.7143 12.9547C15.4571 13.2526 15.2204 13.1302 15.1592 13.0812C14.9673 12.971 14.9061 12.7179 15.0326 12.5261L15.2408 12.1914C15.351 11.9996 15.6041 11.9383 15.7959 12.0649C15.9837 12.1751 16.049 12.4281 15.9224 12.62ZM15.6041 10.4608C15.4939 10.4281 15.3673 10.4281 15.2408 10.4281C15.0204 10.4445 14.8286 10.2853 14.8122 10.0649C14.7959 9.84447 14.9551 9.65263 15.1755 9.6363C15.3837 9.61998 15.5878 9.6363 15.7959 9.68528C16.0163 9.73426 16.1469 9.95467 16.098 10.1792C16.049 10.3506 15.849 10.522 15.6041 10.4608Z"
            fill="black"
          />
        </g>
        <defs>
          <clipPath id="clip0_199_2">
            <rect width="20" height="20" fill="white" />
          </clipPath>
        </defs>
      </svg>
    </div>
  </div>
</template>

<script setup lang="ts">
import { useTheme } from "~/utils/theme";

const { getTheme, setTheme } = useTheme();
const currentTheme = useState<string>("theme", () => getTheme());

const toggleTheme = () => {
  const newTheme = currentTheme.value === "light" ? "dark" : "light";
  currentTheme.value = newTheme;
  setTheme(newTheme);

  // Применяем тему на стороне клиента
  document.documentElement.setAttribute("data-theme", newTheme);
};
</script>

<style lang="scss">
.switch {
  display: inline-block;

  &-rounded {
    width: 55px;
    height: 30px;
    padding: 3px;
    border-radius: 15px;
    border: 2.5px solid var(--icons);
    cursor: pointer;
    transition: all 0.4s;
    transform: scale(0.7);
    position: relative;

    svg {
      display: block;
      position: absolute;
      top: 3px;
      left: 3px;
      width: 20px;
      height: 20px;
      border-radius: 12px;
      background: var(--icons);
      transition: all 0.4s;
      path {
        fill: var(--background);
      }
    }

    &--active {
      svg {
        transform-box: fill-box;
        transform-origin: 50% 50%;
        transform: rotate(180deg);
        left: 26px;
      }
    }
  }
}
</style>
